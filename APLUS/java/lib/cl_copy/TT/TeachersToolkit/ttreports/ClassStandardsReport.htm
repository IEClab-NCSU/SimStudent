<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
	<xsl:output method="html" encoding="UTF-8" />
	<xsl:param name="useIds"/>

	<xsl:template match="/Report">
		<div style="font-weight: bold; font-size: medium; color: #5582d5">CLASS PROGRESS per STANDARDS</div>
       <xsl:element name="table" use-attribute-sets="top-table">
			<!-- top-table -->
			<tr height="10">
				<!-- EMPTY ROW to add spacing -->
				<td colspan="4"></td>
			</tr>
			<tr>
				<td style="font-weight: bold; padding: 0 15px 0 0;">STANDARDS</td>
				<td nobreak="nobreak"><xsl:value-of select="StandardSet/@id"/></td>
				<td style="font-weight: bold; padding: 0 15px 0 30px;">INSTRUCTOR</td>
				<td><xsl:value-of select="@instructor_name" /></td>
			</tr>
			<tr valign="top">
				<td style="font-weight: bold; padding: 0 15px 0 0;">DATE</td>
				<td><xsl:value-of select="@timestamp" /></td>
				<td style="font-weight: bold; padding: 0 15px 0 30px;" valign="top">CLASS</td>
				<td><xsl:value-of select="@class_name" /></td>
			</tr>
			<tr height="10">
				<!-- EMPTY ROW to add spacing #83b3ce;-->
				<td colspan="4"></td>
			</tr>
			<!-- END top-table -->
		</xsl:element>

		<xsl:element name="table" use-attribute-sets="standards-table">
            <xsl:for-each select="StandardSet">
                <!-- Standards Table Header -->
				<tr style="background-color: #7399C6; color: #FFFFFF;">
					<td/>
                    <td style="background-color: #C9DDF4; font-size: x-small; padding: 0 0 0 0" align="center"></td>
                    <!-- we'll have 2 rows for the strand - the short name on one, the grade level on the other -->
                    <xsl:for-each select="StandardStrand">
						<xsl:element name="td">
                            <xsl:attribute name="colspan">
								<xsl:value-of select="count(Standard)"/>
							</xsl:attribute>
                            <xsl:attribute name="align">center</xsl:attribute>
                            <xsl:value-of select="@name"/>
						</xsl:element>
                        <td style="background-color: #C9DDF4; font-size: x-small; padding: 0 0 0 0" align="center"></td>
                    </xsl:for-each>
                    <td/>
                </tr>
                <tr style="background-color: #C9DDF4;">
                    <td/>
                    <td style="background-color: #C9DDF4; font-size: x-small; padding: 0 0 0 0" align="center"></td>
                    <!-- we'll have 2 rows for the strand - the short name on one, the grade level on the other -->
                    <xsl:for-each select="StandardStrand">
                        <xsl:element name="td">
                            <xsl:attribute name="colspan">
                                <xsl:value-of select="count(Standard)"/>
                            </xsl:attribute>
                            <xsl:attribute name="align">center</xsl:attribute>
                            <xsl:value-of select="@grade_level"/>
                        </xsl:element>
                        <td style="background-color: #C9DDF4; font-size: x-small; padding: 0 0 0 0" align="center"></td>
                    </xsl:for-each>
                    <td/>
                </tr>
				<tr style="background-color: #7399C6; color: #FFFFFF;">
					<td>STUDENT</td>
                    <td style="background-color: #C9DDF4; font-size: x-small; padding: 0 0 0 0" align="center"></td>
					<xsl:for-each select="StandardStrand">
						<xsl:for-each select="Standard">
							<td nobreak="nobreak" align="center"><xsl:value-of select="@std_code"/></td>
						</xsl:for-each>
                        <td style="background-color: #C9DDF4; font-size: x-small; padding: 0 0 0 0" align="center"></td>
                    </xsl:for-each>
                    <td/>
                </tr>
			</xsl:for-each>

			<xsl:for-each select="Student">
				<!-- Standards Table Rows -->
				<xsl:variable name="bkgd">
					<xsl:choose>
						<xsl:when test="position() mod 2 = 1">#ffffff</xsl:when>
						<xsl:otherwise>#C9DDF4</xsl:otherwise>
					</xsl:choose>
				</xsl:variable>
				<tr style="background: {$bkgd};" valign="center">
					<td>
						<xsl:choose>
							<xsl:when test="$useIds = 'true'">
								<xsl:choose>
									<xsl:when test="@id != ''">
										<xsl:value-of select="@id" />
									</xsl:when>
									<xsl:otherwise>
										-
									</xsl:otherwise>
								</xsl:choose>
							</xsl:when>
							<xsl:otherwise>
								<xsl:value-of select="@name" />
							</xsl:otherwise>
						</xsl:choose>
					</td>
                    <td style="background-color: #C9DDF4; font-size: x-small; padding: 0 0 0 0" align="center"></td>
					<xsl:for-each select="StudentStandard">
                        <xsl:choose>
							<xsl:when test="@value = 'mastered'">
								<td style="color: #3f668e; font-size: x-large; font-weight: bold" align="center" valign="center">&amp;#9679;</td>
							</xsl:when>
							<xsl:when test="@value = 'inprogress'">
								<td style="color: #3f668e; font-size: x-large; font-weight: bold" align="center" valign="center">&amp;#9675;</td>
							</xsl:when>
                            <xsl:when test="@value = 'inprogress_flag'">
                                <td style="color: #ED1C24; font-size: x-large; font-weight: bold" align="center" valign="center">&amp;#9688;</td>
                            </xsl:when>
							<xsl:when test="@value = 'notmastered'">
								<td style="color: #ED1C24; font-size: xx-large; font-weight: bold" align="center" valign="center">&amp;#9632;</td>
							</xsl:when>
                            <xsl:when test="@value = 'notcovered'">
                                <td style="color: #3f668e; font-size: x-large" align="center">-</td>
                            </xsl:when>
                            <xsl:when test="@value = 'spacer'">
                                <td style="background-color: #C9DDF4; font-size: x-small; padding: 0 0 0 0" align="center" valign="center"></td>
                            </xsl:when>
                            <xsl:otherwise> <!-- not yet encountered -->
								<td style="color: #3f668e; font-size: x-large; font-weight: bold" align="center" valign="center">&amp;#9702;</td>
							</xsl:otherwise>
						</xsl:choose>
					</xsl:for-each>
                    <td/>
                </tr>
			</xsl:for-each>

			<!-- standards table bottom row -->
			<tr style="background-color: #7399C6; color: #FFFFFF;">
				<xsl:element name="td">
					<xsl:attribute name="colspan">
						<xsl:value-of select="count(StandardSet/StandardStrand/Standard) + 2"/>
					</xsl:attribute>
				</xsl:element>
			</tr>
		</xsl:element>

		<xsl:element name="table" use-attribute-sets="legend-table">
			<!-- Legend -->
            <tr>
                <td  width="20px" />
                <td style="color: #3f668e; font-size: x-large">&amp;#9702;</td>  <!-- not encountered -->
                <td>Not yet encountered</td>
                <td width="50px"/>
                <td style="color: #3f668e; font-size: x-large; font-weight: bold">&amp;#9675;</td> <!-- in progress -->
                <td>In progress: Mastering</td>
                <td width="50px"/>
                <td style="color: #3f668e; font-size: x-large; font-weight: bold">&amp;#9679;</td> <!-- mastereed -->
				<td>Complete: Mastered</td>
            </tr>
            <tr>
                <td  width="20px" />
                <td style="color: #3f668e; font-size: x-large">-</td>  <!-- not covered -->
                <td>Not Covered</td>
                <td width="50px"/>
                <td style="color: #ED1C24; font-size: x-large; font-weight: bold">&amp;#9688;</td> <!-- flagged progres -->
                <td>In progress: Not Mastering</td>
                <td width="50px"/>
				<td style="color: #ED1C24; font-size: xx-large; font-weight: bold">&amp;#9632;</td>  <!-- not mastered -->
				<td>Complete: Not Mastered</td>
            </tr>
 			<tr height="10">
				<!-- EMPTY ROW to add spacing -->
				<td colspan="4"></td>
			</tr>
        </xsl:element>

        <!-- todo can we get a pagebreak in here  -->

        <xsl:element name="table" use-attribute-sets="standards-descr-table">
			<!-- standard description table -->
			<xsl:for-each select="StandardSet">
    			<tr style="background-color: #7399C6; color: #FFFFFF;">
					<td colspan="3"><b><xsl:value-of select="@description"/></b></td>
				</tr>
				<xsl:for-each select="StandardStrand">
					<tr style="background-color: #C9DDF4; color: #000000;">
						<td width="20px"></td>
						<td colspan="2"><xsl:value-of select="@description"/></td>
					</tr>
					<xsl:for-each select="Standard">
						<!-- <xsl:variable name="bkgd">
							<xsl:choose>
								<xsl:when test="position() mod 2 = 1">#E4EEF7</xsl:when>
								<xsl:otherwise>#C9DDF4</xsl:otherwise>
							</xsl:choose>
						</xsl:variable>
							-->
						<tr style="background: #FFFFFF " >  <!--{$bkgd};">  -->
							<td></td>
							<td><xsl:value-of select="@std_code"/></td>
							<td><xsl:value-of select="@description"/></td>
						</tr>
					</xsl:for-each>
				</xsl:for-each>
			</xsl:for-each>
		</xsl:element>

	</xsl:template>

	<xsl:attribute-set name="top-table">
		<xsl:attribute name="border">0</xsl:attribute>
		<xsl:attribute name="align">left</xsl:attribute>
		<xsl:attribute name="cellpadding">0</xsl:attribute>
		<xsl:attribute name="cellspacing">0</xsl:attribute>
		<xsl:attribute name="clear">both</xsl:attribute>
		<xsl:attribute name="style">clear: both; font-size: small;</xsl:attribute>
	</xsl:attribute-set>

	<xsl:attribute-set name="standards-table">
		<xsl:attribute name="border">0</xsl:attribute>
        <xsl:attribute name="cellpadding">2</xsl:attribute>
        <xsl:attribute name="align">center</xsl:attribute>
        <xsl:attribute name="valign">top</xsl:attribute>
		<xsl:attribute name="width">100%</xsl:attribute>
        <xsl:attribute name="clear">both</xsl:attribute>
		<xsl:attribute name="style">clear: both; font-size: small;</xsl:attribute>
	</xsl:attribute-set>

	<xsl:attribute-set name="standards-descr-table">
		<xsl:attribute name="border">0</xsl:attribute>
		<xsl:attribute name="align">left</xsl:attribute>
		<xsl:attribute name="cellpadding">2</xsl:attribute>
		<xsl:attribute name="cellspacing">0</xsl:attribute>
		<xsl:attribute name="width">100%</xsl:attribute>
		<xsl:attribute name="style">clear: both; font-size: small;</xsl:attribute>
	</xsl:attribute-set>

	<xsl:attribute-set name="legend-table">
		<xsl:attribute name="border">0</xsl:attribute>
		<xsl:attribute name="align">left</xsl:attribute>
		<xsl:attribute name="cellpadding">2</xsl:attribute>
		<xsl:attribute name="cellspacing">1</xsl:attribute>
		<xsl:attribute name="style">clear: both; font-size: small;</xsl:attribute>
	</xsl:attribute-set>
</xsl:stylesheet>