/**
 * @fileoverview Defines the CTATConfig object which stores some important
 * configuration parameters that can affect the behavior of the entire
 * CTAT tutor.
 *
 * @author $Author$
 * @version $Revision$
 */
/*
 $Date$
 $HeadURL$

 -
 License:
 -
 ChangeLog:
 -
 Notes:

 */
goog.provide('CTATConfig');

CTATConfig = {};
/**
 * Defines the possible values for each property for introspection.
 */
CTATConfig.Options = {};

/**
 * Define a property for CTATConfig.
 * @param {String} property_name	the name of the property to add.
 * @param {Array} possible_values	An array of strings listing names of values
 *  that the property can have.  These names are used to defined the names of
 *  the query functions: <property_name>_is_<possible_values[i]>().  The actual
 *  values are the lower case forms.
 * @param {String} [default_value=possible_values[0]]	The value of the parameter.
 * @param {Boolean} [is_constant=false]	True if the parameter is immutable.
 * Note: side effects include adding a property of the given name to CTATConfig,
 * setting its value and other attributes, adding the possible values to
 * CTATConfig.Options.<property_name>, and adding
 * CTATConfig.<property_name>_is_<possible_values[i]>() functions.
 */
CTATConfig.addProperty = function(property_name,possible_values,default_value,is_constant) {
	default_value = default_value || possible_values[0]; // default to first possible value
	// Add the property to CTATConfig
	Object.defineProperty(CTATConfig, property_name, {
		enumerable: true,
		configurable: false,
		writable: !is_constant,
		value: default_value.toLowerCase()
	});
	var opts = {}; // store the options mapping
	possible_values.forEach(function(opt) {
		opts[opt] = opt.toLowerCase(); // Map <Name>: <Name>.toLowerCase()
		// define the function CTATConfig.<property_name>_is_<possible_values[i]>()
		Object.defineProperty(CTATConfig, property_name+'_is_'+opt, {
			enumerable: false, writable: false, value: function() {
				return CTATConfig[this.prop].toLowerCase() == this.val; // toLowerCase to make sure capitalization is ignored.  this.val already lower-cased
			}.bind({prop: property_name, val: opts[opt]})
		});
	});
	CTATConfig.Options[property_name] = opts; // add options to CTATConfig.Options.<property_name>
};

CTATConfig.addProperty('platform',['CTAT','Google','Undefined'],'CTAT',true);

CTATConfig.addProperty('external',['Google','LTI','SCORM','None'],'None');

// Either one of json or xml, this only configures the format of the expected incoming message from the tracer. Outgoing
// messages will still be in xml format.
CTATConfig.addProperty('parserType',['XML','JSON'],'XML');


if (typeof module !== 'undefined')
{
    module.exports = CTATConfig;
}
if(window && window.console)  // turn on global debugging if console on
{
    //window.useDebugging = true;
}
